## Estructura general de una regla en Suricata
Una regla en Suricata se compone de dos partes principales:
  1. **Encabezado** (Header): Define los aspectos b√°sicos del tr√°fico a analizar (protocolo, IP, puertos, etc.).
  2. **Opciones** (Rule Options): Especifica las condiciones que deben cumplirse para que se active la alerta, como patrones de payload o flags espec√≠ficos.

<br>

## Encabezado de regla
El encabezado define las caracter√≠sticas b√°sicas del paquete que Suricata debe inspeccionar.
Definici√≥n general:
```yaml
  <acci√≥n> <protocolo> <IP Origen> <puerto Origen> <sentido del tr√°fico> <IP Destino> <puerto destino>
```

* **Acci√≥n**: Define lo que hace Suricata cuando se activa la regla:
  * alert: Genera una alerta.
  * drop: Descarta el paquete.
  * reject: Rechaza la conexi√≥n y env√≠a un mensaje de error al cliente.
  * pass: Ignora el tr√°fico y no lo inspecciona m√°s.

* **Protocolo**: Especifica el protocolo a inspeccionar (tcp, udp, icmp, http, etc.).
* **Direcci√≥n origen**: Indica la IP o rango de IPs de origen. Se puede usar:
  * IP espec√≠fica: 192.168.1.1
  * Rango CIDR: 192.168.1.0/24
  * Cualquier direcci√≥n: any
  * Puerto origen: Especifica el puerto de origen o any para cualquiera.
* **Puerto origen**: Especifica el puerto de origen o any para cualquiera.
* **Operador de direcci√≥n**: Define la direcci√≥n del tr√°fico:
  * ->: Tr√°fico unidireccional (origen ‚Üí destino).
  * <->: Tr√°fico bidireccional.
* **Direcci√≥n destino**: Igual que la direcci√≥n de origen, pero para el destino.
* **Puerto destino**: Lo mismo que el puerto de origen.

üî∏ Ejemplos:
* `alert tcp any any -> 10.0.0.1 22`         ‚Üí Alerta sobre tr√°fico TCP hacia la IP 10.0.0.1 en el puerto 22 (SSH).
* `alert udp 192.168.1.0/24 any -> any 53`   ‚Üí Alerta sobre tr√°fico UDP desde la red 192.168.1.0/24 hacia cualquier IP en el puerto 53 (DNS).

## Opciones de reglas
Las opciones definen las condiciones que deben cumplirse para activar la regla. Se encierran entre par√©ntesis `( )` y cada opci√≥n termina con `;`.

Ejemplo:
```
(msg:"Posible ataque XSS"; content:"<script>"; nocase; sid:1001; rev:1;)
```

