## Estructura general de una regla en Suricata
Una regla en Suricata se compone de dos partes principales:
  1. **Encabezado** (Header): Define los aspectos bÃ¡sicos del trÃ¡fico a analizar (protocolo, IP, puertos, etc.).
  2. **Opciones** (Rule Options): Especifica las condiciones que deben cumplirse para que se active la alerta, como patrones de payload o flags especÃ­ficos.

<br>

## ğŸ“Œ Encabezado de regla
El encabezado define las caracterÃ­sticas bÃ¡sicas del paquete que Suricata debe inspeccionar.
DefiniciÃ³n general:
```yaml
  <acciÃ³n> <protocolo> <IP Origen> <puerto Origen> <sentido del trÃ¡fico> <IP Destino> <puerto destino>
```

* **AcciÃ³n**: Define lo que hace Suricata cuando se activa la regla:
  * alert: Genera una alerta.
  * drop: Descarta el paquete.
  * reject: Rechaza la conexiÃ³n y envÃ­a un mensaje de error al cliente.
  * pass: Ignora el trÃ¡fico y no lo inspecciona mÃ¡s.

* **Protocolo**: Especifica el protocolo a inspeccionar (tcp, udp, icmp, http, etc.).
* **DirecciÃ³n origen**: Indica la IP o rango de IPs de origen. Se puede usar:
  * IP especÃ­fica: 192.168.1.1
  * Rango CIDR: 192.168.1.0/24
  * Cualquier direcciÃ³n: any
  * Puerto origen: Especifica el puerto de origen o any para cualquiera.
* **Puerto origen**: Especifica el puerto de origen o any para cualquiera.
* **Operador de direcciÃ³n**: Define la direcciÃ³n del trÃ¡fico:
  * ->: TrÃ¡fico unidireccional (origen â†’ destino).
  * <->: TrÃ¡fico bidireccional.
* **DirecciÃ³n destino**: Igual que la direcciÃ³n de origen, pero para el destino.
* **Puerto destino**: Lo mismo que el puerto de origen.

ğŸ”¸ Ejemplos:
* `alert tcp any any -> 10.0.0.1 22`         â†’ Alerta sobre trÃ¡fico TCP hacia la IP 10.0.0.1 en el puerto 22 (SSH).
* `alert udp 192.168.1.0/24 any -> any 53`   â†’ Alerta sobre trÃ¡fico UDP desde la red 192.168.1.0/24 hacia cualquier IP en el puerto 53 (DNS).

<br>

## ğŸ“Œ Opciones de reglas
Las opciones definen las condiciones que deben cumplirse para activar la regla. Se encierran entre parÃ©ntesis `( )` y cada opciÃ³n termina con `;`.

Ejemplo:
```
(msg:"Posible ataque XSS"; content:"<script>"; nocase; sid:1001; rev:1;)
```

## Opciones comunes en reglas de Suricata
* **msg**: (Mensaje de alerta)
Define el mensaje que aparecerÃ¡ en los registros cuando la regla se active.

Ejemplo:
```
alert tcp any any -> any 22 (msg:"Intento de conexiÃ³n SSH detectado"; sid:1001; rev:1;)
```
Cuando alguien intente conectarse al puerto 22 (SSH), se generarÃ¡ una alerta con el mensaje:
"*Intento de conexiÃ³n SSH detectado*".
